<!-- dcterms:identifier = aspnetcz#228 -->
<!-- dcterms:title = Tisk z webových aplikací -->
<!-- dcterms:abstract = Požadavek na tiskový výstup z webových aplikací je dosti častý. A protože jeho splnění není zcela jednoduché, může se stát vlčí jámou webových vývojářů. Poslední dobou se mi v mailu sešlo hned několik dotazů na toto téma, pročež jsem se rozhodl napsat tento přehledový článek. Měl by vám posloužit jako úvod do problematiky a návod k řešení nejtypičtějších problémů. -->
<!-- np9:categoryId = 1 -->
<!-- x4w:category = IT -->
<!-- np9:authorId = 1 -->
<!-- np9:authorEmail = michal.valasek@altairis.cz -->
<!-- dcterms:creator = Michal Altair Valášek -->
<!-- dcterms:created = 2009-04-19T22:54:00.263+02:00 -->
<!-- dcterms:date = 2009-04-19T22:54:00.263+02:00 -->

<p>Již nějakých dvacet let lze slýchat pojem &quot;bezpapírová kancelář&quot;. Ovšem všechny ideje - od snahy naskenovat každý kus papíru po rozličné systémy elektronické výměny dokumentů - mají jedno společné: fungují přesně opačně. Rozšíření počítačů (a zejména levných a rychlých tiskáren) ve skutečnosti vedlo je zvýšení množství tištěných dokumentů.</p>  <p>Požadavek na tiskový výstup z webových aplikací je tedy stále častý. A protože jeho splnění není zcela jednoduché, může se stát vlčí jámou webových vývojářů. Poslední dobou se mi v mailu sešlo hned několik dotazů na toto téma, pročež jsem se rozhodl napsat tento přehledový článek. Měl by vám posloužit jako úvod do problematiky a návod k řešení nejtypičtějších problémů.</p>  <p>Tiskové požadavky lze v případě webových aplikací rozdělit do čtyř základních skupin. První je <strong>běžný tisk</strong> jednoduše strukturovaného dokumentu, kde jde o jeho obsah, nikoliv o přesné formátování. Například když si uživatel chce informace číst bez počítače a podobně. Druhou skupinu tvoří <strong>tiskové sestavy</strong>, kdy chceme mít nad vzhledem dokumentu jistou kontrolu, ale netrváme na absolutní věrnosti. Například tisk objednávek, faktur a dalších dokladů tohoto typu. Třetí skupina je případ, kdy je nutné nad tiskem mít <strong>detailní kontrolu</strong>. Například pokud je nutné doplňovat data do předtištěných formulářů a nebo chceme zajistit, aby výsledek měl z jiného důvodu přesné rozměry&#160; pozicování. Poslední skupinu pak tvoří speciální případy, jako například tisk na pokladních tiskárnách a jiných specifických zařízení.</p>  <h2>Úprava běžných stránek pro tisk</h2>  <p>Všechny stránky by mělo být možné vytisknout. A prohlížeč se o to ochotně postará, stačí stisknout <em>Ctrl-P</em>. Bohužel, výsledek bývá mnohdy nevalný, layout rozhozený a použitelnost výtisku mizerná, zejména pokud si designér vymyslí bílé písmo na černém pozadí a podobné vylomeniny. Prohlížeče se sice obecně snaží stránky pro tisk upravovat, ale mnohdy je třeba jim pomoci. </p>  <p>V případě tisku je typicky vhodné některé elementy (hlavičku, menu…) vůbec nezobrazovat. Ačkoliv barevné tiskárny dnes nejsou tak exotickou záležitostí, jako před několika lety, vyplatí se ubrat na barvách. I když uživatel disponuje barevnou tiskárnou, černobílý tisk je zpravidla levnější a téměř vždy rychlejší, takže nenese-li barva nějakou podstatnou informaci, je lepší se bez ní obejít.</p>  <p>Existují v zásadě dvě cesty, jak tiskové verze stránek realizovat. První spočívá v tom, že vytvoříte samostatnou stránku s &quot;verzí pro tisk&quot;, což je zejména v případě dynamicky generovaných webů celkem snadné. Toto řešení má několik výhod i nevýhod. Výhodou je, že uživatel přímo vidí, že se stránka změnila a jak se bude tisknout. Samostatnou stránku lze snadno využít i k jiným účelům, typicky třeba pro mobilní zařízení nebo nějak zdravotně postižené uživatele, kterým prospěje lepší čitelnost. Nicméně, pokud je váš web tak hrozný, že je nutné si zobrazit tiskovou verzi aby bylo možné ho rozumně číst, měli byste se nad sebou zamyslet. Nevýhodou tohoto přístupu je zejména duplikace obsahu a nestandardní ovládání. Duplikace obsahu může znamenat problém z hlediska vyledávačů a optimalizace pro ně, případně přivedení uživatelů z vyhledávače na tiskovou verzi a ztráta kontextu. Pokud se touto cestou vydáte, doporučuji odkazy na tiskovou verzi opatřit atributem <em>rel=&quot;nofollow&quot;</em>. Nestandardní ovládání je problém z hlediska použitelnosti, protože uživatel musí hledat nějaký specifický odkaz pro tisk na vašem webu (přičemž ani neví, zda tento existuje), místo aby prostě použil standardní funkci &quot;tisk&quot; svého browseru.</p>  <p>Mnohem vhodnější, než vytvářet samostatnou stránky pro tisk, je posle mého soudu využít vlastností CSS a vytvořit samostatný styl pro obrazovku a pro tisk. </p>  <p>Mějme například následující dokument:</p>  <div style="font-family: consolas, courier new; background: white; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">&lt;!</span><span style="color: #a31515">DOCTYPE</span> <span style="color: red">html</span> <span style="color: red">PUBLIC</span> <span style="color: blue">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span style="color: blue">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">html</span> <span style="color: red">xmlns</span><span style="color: blue">=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">head</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">title</span><span style="color: blue">&gt;</span>Untitled Page<span style="color: blue">&lt;/</span><span style="color: #a31515">title</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">link</span> <span style="color: red">rel</span><span style="color: blue">=&quot;stylesheet&quot;</span> <span style="color: red">type</span><span style="color: blue">=&quot;text/css&quot;</span> <span style="color: red">media</span><span style="color: blue">=&quot;screen&quot;</span> <span style="color: red">href</span><span style="color: blue">=&quot;screen.css&quot;</span> <span style="color: blue">/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">link</span> <span style="color: red">rel</span><span style="color: blue">=&quot;stylesheet&quot;</span> <span style="color: red">type</span><span style="color: blue">=&quot;text/css&quot;</span> <span style="color: red">media</span><span style="color: blue">=&quot;print&quot;</span> <span style="color: red">href</span><span style="color: blue">=&quot;print.css&quot;</span> <span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">head</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">body</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">h1</span><span style="color: blue">&gt;</span>Toto je nadpis<span style="color: blue">&lt;/</span><span style="color: #a31515">h1</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">p</span> <span style="color: red">class</span><span style="color: blue">=&quot;screenonly&quot;&gt;</span>Tento text chci zobrazit na obrazovce, ale ne tisknout.<span style="color: blue">&lt;/</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">p</span> <span style="color: red">class</span><span style="color: blue">=&quot;printonly&quot;&gt;</span>Tento text chci vytisknout, ale nezobrazovat ho na obrazovce.<span style="color: blue">&lt;/</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">body</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">html</span><span style="color: blue">&gt;</span></p> </div>  <p>Atribut <em>media</em> elementu <em>link</em> zajistí, že pro zobrazení na obrazovce se použijí styly v souboru <em>screen.css</em> a pro tisk (a také náhlad před tiskem, takže můžete ladit bez nutnosti spotřebovat hromadu papíru) styly v <em>print.css</em>. Jinak oněch médií je víc, než jenom <em>screen</em> a <em>print</em>, ale dosud jsem se nesetkal s jejich praktickou implementací v žádném z běžných prohlížečů.</p>  <p>Výše uvedenou &quot;výhybku&quot; můžete realizovat i uvnitř souboru se stylem, který pak nalinkujete běžným způsobem. To se vám může hodit třeba při použití ASP.NET Themes, které vám nalinkují CSS automaticky. Obsah takového souboru může vypadat například následovně:</p>  <div style="font-family: consolas, courier new; background: white; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: green">/* Tyto styly se použijí pro obrazovku */</span></p>    <p style="margin: 0px"><span style="color: blue">@media</span> screen {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">body</span> {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">font-family</span>: <span style="color: blue">Arial,</span> <span style="color: blue">Helvetica,</span> <span style="color: blue">Sans-Serif</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">background-color</span>: <span style="color: blue">#cccccc</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">color</span>: <span style="color: blue">#000033</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">h1</span> {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">color</span>: <span style="color: blue">#0000ff</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">.printonly</span> {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">display</span>: <span style="color: blue">none</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px"><span style="color: green">/* Tyto styly se použijí pro tisk */</span></p>    <p style="margin: 0px"><span style="color: blue">@media</span> print {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">body</span> {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">font-family</span>: <span style="color: blue">'Times New Roman'</span> <span style="color: blue">,</span> <span style="color: blue">Serif</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">background-color</span>: <span style="color: blue">#ffffff</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">color</span>: <span style="color: blue">#000000</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">h1</span> {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">color</span>: <span style="color: blue">#000000</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">.screenonly</span> {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">display</span>: <span style="color: blue">none</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">}</p> </div>  <p>Uvedené styly také ukazují některé postupy, které budete patrně chtít použít:</p>  <ul>   <li><strong>Barvy:</strong> v zájmu šetření časem a tonerem tiskneme černé na bílém, včetně nadpisů, které jsou jinak barevně odlišené. Stejným způsobe doporučuji zachovat se i k odkazům. </li>    <li><strong>Fonty:</strong> na obrazovce je čitelnější bezpatkové písmo, na papíře patkové. Obrazovka má malé rozlišení (myšleno DPI, hustotu bodů, typicky 72 dpi) a proto patky nezobrazí pořádně a oko spíš ruší. Tisk na papíře má velké rozlišení (typicky 300-600 dpi) a patky oko &quot;vedou&quot; při čtení. </li>    <li><strong>Skrytí prvků:</strong> například menu a hlavičku budeme při tisku patrně chtít schovat. </li>    <li><strong>Zobrazení prvků:</strong> je možné vytvořit speciální hlavičku pro tisk a skrýt ji naopak v obrazovkovém režimu. </li> </ul>  <h2>Tvorba jednoduchých tiskových sestav</h2>  <p>Druhou velkou skupinu tiskových úloh tvoří případy, kdy stránku vytváříme speciálně pro účely tisku. Typickým příkladem budiž vygenerovaná faktura. I zde nám pomůžou kaskádové styly.</p>  <p>Jako první se nám může hodit schopnost CSS specifikovat rozměry nejenom v pixelech a podobných jednotkách, ale také v milimetrech nebo centimetrech.&#160; Následující konstrukce je tedy perfektně legální a většinou celkem funkční:</p>  <div style="font-family: consolas, courier new; background: white; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">div</span> <span style="color: red">style</span><span style="color: blue">=&quot;</span><span style="color: red">width</span>: <span style="color: blue">10mm</span>; <span style="color: red">height</span>: <span style="color: blue">1cm</span>; <span style="color: red">border</span>: <span style="color: blue">solid</span> <span style="color: blue">5mm</span> <span style="color: blue">black&quot;&gt;</span><span style="color: red">&amp;nbsp;</span><span style="color: blue">&lt;/</span><span style="color: #a31515">div</span><span style="color: blue">&gt;</span></p> </div>  <p>Prohlížeč se nám pokusí vyhovět, pokud mu v tom nebrání závažné okolnosti. Takovými okolnostmi může být třeba nastavení okrajů stránky a rozměry papíru. Pak prohlížeč stránku různým způsobem upraví tak, by se mu tisk na papír vešel. Každý prohlížeč to dělá jinak a mluvit do toho má co i uživatel, který může většinou ony tiskové okraje celkem pohodlně měnit. Na určení rozměrů tímto způsobem se nelze moc spolehnout a na určení pozice prvků už teprve ne.</p>  <p>Určení rozměrů je dobré v případě, že se spokojíte s přibližnou hodnotou. V duchu &quot;tohle chci na orní půlce stránky a tohle někde na dolní&quot;, protože předmětnou stránku pak budete chtít napůl přeložit a rozříznout, například.</p>  <p>Pomocí kaskádových stylů můžeme také manipulovat se zalomením stránky. CSS vlastnosti <em>page-break-before</em> a <em>page-break-after</em> umožňují vynutit si zalomení stránky před nebo za daným elementem, nastavíme-li je na hodnotu always. Vlastnost <em>page-break-inside</em> nastavená na <em>avoid</em> pak prohlížeči říká, aby obsah elementu vytiskl pokud možno na jedné stránce (např. tabulku).</p>  <p>Nastavení těchto vlastností se v běžném zobrazení nijak neprojeví, já osobně mám ve zvyku používat za tímto účelem patřičně ostylovaný element <em>hr</em>, který ukáže na obrazovce rovnou čáru. Níže uvedený dokument mimochodem ukazuje ještě třetí možnost nastavení média pro styl, a to jako atribut elementu <em>style</em>.</p>  <div style="font-family: consolas, courier new; background: white; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">&lt;!</span><span style="color: #a31515">DOCTYPE</span> <span style="color: red">html</span> <span style="color: red">PUBLIC</span> <span style="color: blue">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span style="color: blue">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">html</span> <span style="color: red">xmlns</span><span style="color: blue">=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">head</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">title</span><span style="color: blue">&gt;</span>Untitled Page<span style="color: blue">&lt;/</span><span style="color: #a31515">title</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">style</span> <span style="color: red">type</span><span style="color: blue">=&quot;text/css&quot;</span> <span style="color: red">media</span><span style="color: blue">=&quot;print&quot;&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">hr</span> {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">visibility</span>: <span style="color: blue">hidden</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">page-break-after</span>: <span style="color: blue">always</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;/</span><span style="color: #a31515">style</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">head</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">body</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span>Strana 1<span style="color: blue">&lt;/</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">hr</span> <span style="color: blue">/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span>Strana 2<span style="color: blue">&lt;/</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">hr</span> <span style="color: blue">/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span>Strana 3<span style="color: blue">&lt;/</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">hr</span> <span style="color: blue">/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span>Strana 4<span style="color: blue">&lt;/</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">hr</span> <span style="color: blue">/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span>Strana 5<span style="color: blue">&lt;/</span><span style="color: #a31515">p</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">body</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">html</span><span style="color: blue">&gt;</span></p> </div>  <p>Velmi častým dotazem je: jak mohu pomocí CSS nebo jakkoliv jinak nastavit velikost okrajů stránky a hlavně vypnout a nebo alespoň nějak ovlivnit záhlaví a zápatí, které tam prohlížeč při tisku přidává? Bohužel, CSS ani žádná jiná technologie nic podobného neumí. Tato nastavení jsou plně v kompetenci uživatele a jeho prohlížeče a dokument do nich nemůže nijak civilizovaně zasahovat. Necivilizovaná řešení zahrnují použití ActiveX prvků a podobných věcí, které globálně modifikují nastavení prohlížeče. Mají společné především to, že nefungují moc spolehlivě, jsou specifické pro daný prohlížeč a obecně je s nimi víc problémů, než za kolik stojí.</p>  <p>Tisk z HTML je, ostatně stejně jako jeho zobazení na obrazovce, spíše přibližná záležitost založená na dobré vůli všech zúčastněných. Přesných výsledků lze dosáhnout pouze ve specifických případech, typicky odladěním pro jedno konkrétní nastavení v konkrétním prohlížeči a na konkrétní tiskárně. Dokumenty je tedy nutné připravovat tak, aby s tím počítaly a například nechávat dostatečně široké okraje (doporučuji 3 cm z každé strany).</p>  <h2>Tvorba pokročilých tiskových sestav</h2>  <p>Třetí možnost je, že potřebujete mít detailní kontrolu nad tím, jak bude výsledek vypadat, zejména pokud se týče rozměrů a pozicování. V takovém případě se potřebujete vymanit ze zajetí prohlížečea HTML. Jedinou spolehlivou metodou je dynamicky vygenerovat dokument, který se pak vytiskne externím programem nebo pluginem prohlížeče. Nejvhodnějším formátem je PDF – který byl ostatně přesně pro tento účel vytvořen. V úvahu připadá ještě XPS a DOC/DOCX. </p>  <p>XPS (XML Paper Specification) je formát od Microsoftu, který má za cíl konkurovat zastaralému PDF a je postavený nad OPS (Open Packaging Specification). Jeho nevýhodou je menší rozšířenost a obtížnější generování, nebo alespoň tedy mně se nepodařilo najít žádný jednoduchý způsob, jak XPS dokumenty generovat programově (jinak než skládat XML dokumenty). </p>  <p>Používat Office formáty (DOC/DOCX, XLS/XLSX) čistě pro tisk je tak trochu overkill, navíc u tiskového formátu je možnost editace spíše nevýhodou.</p>  <p>Osobně tedy používám PDF a pro jeho generování volně dostupnou knihovnu <a href="http://www.pdfsharp.net/">PdfSharp</a>. Tato knihovna umožňuje na stránky kreslit podobným způsobem jako v GDI+ (existuje prý i nějaká podpora pro WPF, ale nemám s ní zkušenosti). Takto vygenerovaný dokument lze vytisknout zcela přesně, samozřejmě s omezeními danými vlastnostmi tiskárny.</p>  <h2>Přímý tisk na speciální tiskárny</h2>  <p>Poslední možností je tisk na speciální zařízení, jako jsou pokladí tiskárny, tiskárny čárových kódů a podobně. Komunikace s těmito zařízeními typicky neprobíhá pomocí standardního tiskového subsystému Windows. Místo toho je obvykle třeba jim posílat nějaké speciální instrukce přímo, nejčastěji přes sériový port. Komunikace s takovými tiskárnami z webového prohlížeče pak není z běžné aplikace možná. Jediným řešením je použít speciální program nebo vlastní ActiveX prvek, který tuto komunikaci zajistí.</p>